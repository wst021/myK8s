---
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations: {}
  labels:
    name: postsql-gitlab
  name: postsql-gitlab
  namespace: scm
  resourceVersion: '683893'
spec:
  progressDeadlineSeconds: 600
  replicas: 1
  revisionHistoryLimit: 10
  selector:
    matchLabels:
      name: postsql
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      creationTimestamp: null
      labels:
        name: postsql
      name: postsql
    spec:
      containers:
        - env:
            - name: POSTGRES_PASSWORD
              value: posqladmin
            - name: DB_USER
              value: gitlab
            - name: DB_PASS
              value: passW1ord
            - name: DB_NAME
              value: gitlab_production
            - name: DB_EXTENSION
              value: pg_trgm
          image: 'postgres:13.11'
          imagePullPolicy: IfNotPresent
          livenessProbe:
            exec:
              command:
                - pg_isready
                - '-h'
                - localhost
                - '-U'
                - postgres
            failureThreshold: 3
            initialDelaySeconds: 60
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 15
          name: postgresql
          ports:
            - containerPort: 5432
              name: postgres
              protocol: TCP
          readinessProbe:
            exec:
              command:
                - pg_isready
                - '-h'
                - localhost
                - '-U'
                - postgres
            failureThreshold: 3
            initialDelaySeconds: 35
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 10
          resources: {}
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
            - mountPath: /var/lib/postgresql
              name: data
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      terminationGracePeriodSeconds: 30
      volumes:
        - name: data
          persistentVolumeClaim:
            claimName: postsql-pvc-data
status:
  availableReplicas: 1
  conditions:
    - lastTransitionTime: '2023-12-09T17:16:00Z'
      lastUpdateTime: '2023-12-09T17:16:42Z'
      message: ReplicaSet "postsql-gitlab-77db64d445" has successfully progressed.
      reason: NewReplicaSetAvailable
      status: 'True'
      type: Progressing
    - lastTransitionTime: '2023-12-10T09:56:41Z'
      lastUpdateTime: '2023-12-10T09:56:41Z'
      message: Deployment has minimum availability.
      reason: MinimumReplicasAvailable
      status: 'True'
      type: Available
  observedGeneration: 1
  readyReplicas: 1
  replicas: 1
  updatedReplicas: 1

